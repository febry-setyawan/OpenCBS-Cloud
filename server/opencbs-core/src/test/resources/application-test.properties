# Test profile configuration for opencbs-core
spring.main.allow-bean-definition-overriding=true

# Test database configuration - using PostgreSQL database
spring.datasource.url=jdbc:postgresql://localhost:5432/opencbs_test
spring.datasource.driverClassName=org.postgresql.Driver
spring.datasource.username=postgres
spring.datasource.password=postgres

# JPA configuration - Hibernate DDL auto is DISABLED as requested
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false

# Disable Hibernate Envers auditing for tests
spring.jpa.properties.org.hibernate.envers.store_data_at_delete=false
spring.jpa.properties.org.hibernate.envers.audit_table_suffix=_audit
spring.jpa.properties.org.hibernate.envers.revision_field_name=rev
spring.jpa.properties.org.hibernate.envers.revision_type_field_name=revtype

# Enable comprehensive SQL schema initialization for testing
spring.sql.init.mode=always
spring.sql.init.schema-locations=classpath:comprehensive-test-schema.sql
spring.sql.init.data-locations=classpath:data.sql
spring.sql.init.continue-on-error=true
spring.jpa.defer-datasource-initialization=false

# Flyway configuration for testing setup
# Disabled due to PostgreSQL 13 compatibility issues with many migration files
# Using comprehensive schema instead
spring.flyway.enabled=false
spring.flyway.clean-disabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration/core
spring.flyway.table=schema_version_test

# Disable security for tests
security.basic.enabled=false

# Template configuration for jasper reports (mock path)
opencbs.template.path=/tmp/templates

# Day closure configuration for tests
day-closure.auto-start-time=0 0 0 * * ?

# Email configuration for tests
email.sender=test@example.com
spring.mail.username=test@example.com
spring.mail.password=testpassword
spring.mail.host=localhost
spring.mail.port=25

# RabbitMQ configuration for tests
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
spring.rabbitmq.virtual-host=/
spring.rabbitmq.direct-exchange=test.direct
spring.rabbitmq.fanout-exchange=test.fanout

# Account balance calculation properties for tests
account-balance-calculation.exchange=test.balance.topic
account-balance-calculation.queue=test.balance.queue
account-balance-calculation.routing-key=test.balance.routing

# Task executor properties for tests
task-executor.min-pool-size=2
task-executor.max-pool-size=10

# Template properties for tests
template.location=/tmp/templates

# Attachment properties for tests
attachment.location=/tmp/attachments

# Core module properties for tests
opencbs.core.enable-interest-accrual=false
opencbs.core.enable-penalty-accrual=false
opencbs.core.enable-auto-repayment=false

# Day closure properties for tests (already configured)
day-closure.auto-start=false
day-closure.auto-start-time=0 0 0 * * ?
day-closure.error-to-emails=

# Disable Swagger documentation for tests
springfox.documentation.enabled=false

# Logging configuration
logging.level.org.springframework.web=INFO
logging.level.com.opencbs=INFO
logging.level.org.springframework.security=INFO
logging.level.org.flywaydb=INFO