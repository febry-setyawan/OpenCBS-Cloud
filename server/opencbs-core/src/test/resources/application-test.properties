# Test profile configuration for opencbs-core
spring.main.allow-bean-definition-overriding=true

# Test database configuration - using H2 in-memory database
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# JPA configuration - create schema from entities for tests
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false

# Disable Hibernate Envers auditing for tests
spring.jpa.properties.org.hibernate.envers.store_data_at_delete=false
spring.jpa.properties.org.hibernate.envers.audit_table_suffix=_audit
spring.jpa.properties.org.hibernate.envers.revision_field_name=rev
spring.jpa.properties.org.hibernate.envers.revision_type_field_name=revtype

# Disable Flyway for tests since migrations are PostgreSQL specific
spring.flyway.enabled=false

# Configure SQL initialization to run after Hibernate creates tables
spring.sql.init.mode=always
spring.jpa.defer-datasource-initialization=true

# Disable security for tests
security.basic.enabled=false

# Template configuration for jasper reports (mock path)
opencbs.template.path=/tmp/templates

# Day closure configuration for tests
day-closure.auto-start-time=0 0 0 * * ?

# Email configuration for tests
email.sender=test@example.com
spring.mail.username=test@example.com
spring.mail.password=testpassword
spring.mail.host=localhost
spring.mail.port=25

# RabbitMQ configuration for tests
spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=guest
spring.rabbitmq.password=guest
spring.rabbitmq.virtual-host=/
spring.rabbitmq.direct-exchange=test.direct
spring.rabbitmq.fanout-exchange=test.fanout

# Account balance calculation properties for tests
account-balance-calculation.exchange=test.balance.topic
account-balance-calculation.queue=test.balance.queue
account-balance-calculation.routing-key=test.balance.routing

# Task executor properties for tests
task-executor.min-pool-size=2
task-executor.max-pool-size=10

# Template properties for tests
template.location=/tmp/templates

# Attachment properties for tests
attachment.location=/tmp/attachments

# Core module properties for tests
opencbs.core.enable-interest-accrual=false
opencbs.core.enable-penalty-accrual=false
opencbs.core.enable-auto-repayment=false

# Day closure properties for tests (already configured)
day-closure.auto-start=false
day-closure.auto-start-time=0 0 0 * * ?
day-closure.error-to-emails=

# Disable Swagger documentation for tests
springfox.documentation.enabled=false

# Logging configuration
logging.level.org.springframework.web=INFO
logging.level.com.opencbs=INFO
logging.level.org.springframework.security=INFO
logging.level.org.flywaydb=INFO